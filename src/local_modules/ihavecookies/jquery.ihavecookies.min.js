/*!
 * ihavecookies - jQuery plugin for displaying cookie/privacy message
 * v0.3.2
 *
 * Copyright (c) 2018 Ketan Mistry (https://iamketan.com.au)
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/mit-license.php
 *
 */
/*!
 * ihavecookies - jQuery plugin for displaying cookie/privacy message
 * v0.3.2
 *
 * Copyright (c) 2018 Ketan Mistry (https://iamketan.com.au)
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/mit-license.php
 *
 */
! function ($) {
    $.fn.ihavecookies = function (event) {
        var $element = $(this),
            settings = $.extend({
                title: "&#x1F36A; Мы используем Cookie-файлы:",
                message: "чтобы улучшить работу сайта и предоставить вам комфортное взаимодействие. Продолжая использовать сайт, вы соглашаетесь с условиями использования файлов cookie и политикой обработки персональных данных",
                link: "../politika-opd",
                delay: 600,
                expires: 30,
                moreInfoLabel: "Подробнее",
                acceptBtnLabel: "Принять Cookies",
                onAccept: function () {
                    var myPreferences = $.fn.ihavecookies.cookie();
                    console.log("Были сохранены следующие настроки..."), console.log(myPreferences)
                },
                uncheckBoxes: !1
            }),
            myCookie = getCookie("cookieControl"),
            myCookiePrefs = getCookie("cookieControlPrefs");
        if (myCookie && myCookiePrefs && "reinit" != event) {
            var cookieVal = !0;
            "false" == myCookie && (cookieVal = !1), dropCookie(cookieVal, settings.expires)
        } else {
            $("#gdpr-cookie-message").remove(), preferences = JSON.parse(myCookiePrefs);
            var cookieMessage = '<div id="gdpr-cookie-message"><h4>' + settings.title + "</h4><p>" + settings.message + ' <a href="' + settings.link + '">' + settings.moreInfoLabel + '</a><p><button id="gdpr-cookie-accept" type="button">' + settings.acceptBtnLabel + "</button></p></div>";
            setTimeout((function () {
                $($element).append(cookieMessage), $("#gdpr-cookie-message").hide().fadeIn("slow", (function () {
                    "reinit" == event && ($("#gdpr-cookie-advanced").trigger("click"), $.each(preferences, (function (index, field) {
                        $("input#gdpr-cookietype-" + field).prop("checked", !0)
                    })))
                }))
            }), settings.delay), $("body").on("click", "#gdpr-cookie-accept", (function () {
                dropCookie(!0, settings.expires), $('input[name="gdpr[]"][data-auto="on"]').prop("checked", !0);
                var prefs = [];
                $.each($('input[name="gdpr[]"]').serializeArray(), (function (i, field) {
                    prefs.push(field.value)
                })), setCookie("cookieControlPrefs", encodeURIComponent(JSON.stringify(prefs)), 365), settings.onAccept.call(this)
            }))
        }
    }, $.fn.ihavecookies.cookie = function () {
        var preferences = getCookie("cookieControlPrefs");
        return JSON.parse(preferences)
    }, $.fn.ihavecookies.preference = function (cookieTypeValue) {
        var control = getCookie("cookieControl"),
            preferences = getCookie("cookieControlPrefs");
        return preferences = JSON.parse(preferences), !1 !== control && (!1 !== preferences && -1 !== preferences.indexOf(cookieTypeValue))
    };
    var dropCookie = function (value, expiryDays) {
            setCookie("cookieControl", value, expiryDays), $("#gdpr-cookie-message").fadeOut("fast", (function () {
                $(this).remove()
            }))
        },
        setCookie = function (name, value, expiry_days) {
            var d = new Date;
            d.setTime(d.getTime() + 24 * expiry_days * 60 * 60 * 1e3);
            var expires = "expires=" + d.toUTCString();
            return document.cookie = name + "=" + value + ";" + expires + ";path=/", getCookie(name)
        },
        getCookie = function (name) {
            for (var cookie_name = name + "=", decodedCookie, ca = decodeURIComponent(document.cookie).split(";"), i = 0; i < ca.length; i++) {
                for (var c = ca[i];
                    " " == c.charAt(0);) c = c.substring(1);
                if (0 === c.indexOf(cookie_name)) return c.substring(cookie_name.length, c.length)
            }
            return !1
        }
}(jQuery);
